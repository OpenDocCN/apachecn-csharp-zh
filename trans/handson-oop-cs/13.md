# 版本控制系统

如今，软件开发已经达到了一个新的水平。它不再仅仅涉及编写代码——软件开发人员现在还必须熟悉一系列重要的工具。没有这些工具，在团队中工作或高效工作变得非常困难。版本控制就是这些工具之一。在各种可用的版本控制系统中，Git 是最受欢迎和最强大的。Git 版本控制在行业中已经存在了相当长的时间，但最近已经成为几乎所有软件公司的一部分。了解 Git 现在对开发人员来说至关重要。在本章中，我们将学习 Git 版本控制系统。让我们看一下我们将要讨论的主题:

*   什么是版本控制系统？
*   Git 是如何工作的
*   在窗口中安装 Git
*   Git 的基础知识
*   Git 中的分支

# 什么是版本控制？

版本控制系统是在开发过程中跟踪软件代码变化的系统或应用程序。软件开发人员过去通过将代码复制到另一个文件夹或机器中来保存代码的备份。如果开发人员或生产机器崩溃，他们可以从备份中获取代码并运行它。但是，手动保存和维护备份很麻烦，容易出错，并且备份系统容易损坏。出于这个原因，开发人员开始寻找一个可以保证代码安全的系统或应用程序。

版本控制在多个程序员在一个项目上工作的情况下也很有用。过去，程序员要么处理不同的文件以避免冲突，要么在一段时间后仔细合并代码。手动合并代码非常危险且耗时。

在版本控制系统中，代码文件中的每一个变化实际上都是代码的新版本。在软件行业，有许多可用的版本控制系统，包括 Git、Subversion、Mercurial 和 Perforce。最流行的版本控制系统 Git 是由软件开发人员 Linus Torvalds 开发的。这是一个了不起的应用程序，现在世界上几乎每个软件公司都在使用它。

# Git 是如何工作的

Git 的主要任务是跟踪代码版本，并允许开发人员在必要时返回到任何以前的状态。这是通过拍摄每个版本的快照并将其保存在本地文件存储系统中来实现的。与其他系统不同，Git 使用本地文件存储来存储快照，这意味着 Git 可以在本地使用——即使没有互联网连接。有了本地版本的 Git，您几乎可以用互联网连接版本的 Git 做任何事情。

在项目中安装 Git 后，您可以选择文件系统的哪个目录要保持 Git 版本控制。通常，项目或目录 Git 中的一个实体——被称为**存储库**。一个存储库可能包含不同的项目，一个项目，或者只是一些项目文件，这取决于您想要在 Git 版本控制中保留什么。有两种方法可以在本地机器上拥有一个 Git 存储库。您可以自己初始化一个 Git 存储库，也可以从远程服务器克隆一个存储库。无论哪种方式，您都将在创建或克隆存储库的同一个文件夹中创建一个名为`.git`的文件夹。这个`.git`文件是本地存储文件，所有与该存储库相关的信息都会存储在那里。Git 以非常高效的方式存储数据，因此文件不会变得很大，即使您有大量的快照。

Git 中有三种主要状态，我们将在以下几节中探讨:

*   修改
*   阶段
*   坚定的

# 修改

当您初始化一个 Git 存储库，然后添加一个新文件或编辑一个现有文件时，该特定文件将在 Git 中被标记为已修改。这意味着该文件包含 Git 在本地存储/数据库中已经存储的快照的一些更改。例如，如果您在 Git 存储库中创建了一个 C#控制台应用程序项目，那么该解决方案的所有文件都将被标记为“已修改”，因为它们在 Git 存储库中都不可用。

# 阶段

在 Git 中，Staged 指的是准备提交的文件。为了防止不需要的文件意外提交到 Git 存储库，Git 在修改和提交之间引入了这一步。当您将文件标记为暂存时，这意味着您希望在下一次提交时提交这些文件。这还为您提供了编辑文件的选项，并且不会将它们暂存起来，因此更改不会保存在存储库中。如果您想在本地机器上应用一些配置，但又不想在存储库中进行这些更改，那么这个特性非常方便。

# 坚定的

提交状态是指文件的某个版本保存在本地数据库中。这意味着拍摄快照并存储在 Git 历史记录中以供将来参考。远程使用存储库时，您将推送的代码实际上只是提交的代码。

让我们看一下下图，了解这些状态之间的流程:

![](assets/b1dcec2a-3c29-49cb-a6ba-66f479de78ce.png)

# 在 Windows 上安装 Git

Git 主要是为基于 Linux 或 Unix 的操作系统开发的。当它越来越受欢迎，Windows 用户开始要求 Git 时，面向 Windows 的 Git 就推出了。在 Windows 上安装 Git 现在是一个非常简单的过程。要安装 Git，请前往[https://git-scm.com/download/win](https://git-scm.com/download/win)。

您将进入如下截图所示的页面:

![](assets/e9c46f12-f598-401c-b98f-be26af4608c6.png)

Windows 的 Git 应该会自动开始下载。如果没有开始，你可以点击网站上给出的链接。下载文件将是一个可执行文件，因此要开始安装，请执行该可执行文件。在安装过程中，如果您不确定选择什么，这里最好的选择是将所有内容保留为默认值。

以下屏幕截图显示了您可以安装的组件:

![](assets/ad9369d6-e2e5-4c3a-9228-8f271256a146.png)

有一个部分，您可以选择 Git 使用的默认编辑器。选择的默认编辑器是 Vim，如下图所示。如果您不习惯使用 Vim，您可以将其更改为您的首选:

![](assets/414ae3e5-f6db-4317-88ed-8c6832b39bfb.png)

跟着步骤走。安装 Git 后，要测试安装是否成功，请转到命令行或 PowerShell 并键入以下内容:

```cs
git --version
```

您应该会看到类似如下的输出:

![](assets/bcab6f8b-19bd-42a5-8411-ff126aa10c0c.png)

如果您可以看到版本号，这意味着安装成功。

# Git 的基础知识

如上所述，Git 最初是为 Linux 系统开发的，这就是为什么使用这个工具的主要方式是通过命令行。在 Windows 上，我们不像 Linux 或 Unix 用户那样经常使用命令行，但是使用它可以让您访问 g it 的所有功能。对于 Windows，有一些 GUI 工具可以用于 Git 操作，但是它们通常有一些限制。由于命令行是 Git 的首选方法，我们将在本书中只介绍命令行命令。

# 吉特配置

`git config`命令是用于配置您的 Git 设置的命令。Git 的最低设置是设置用户名和电子邮件地址。您可以不同地配置每个 Git 存储库，也可以全局配置设置。如果您全局设置配置，则不必在每次初始化 Git 存储库时都配置电子邮件地址和用户名。如果需要，您可以在每个存储库中覆盖这些。

要配置您的电子邮件地址和用户名，请运行以下命令:

```cs
git config user.name = "john"
git config user.email = "john@example.com"
```

如果要全局设置配置，需要添加`--global`关键字，如下:

```cs
git config --global user.name = "john"
git config --global user.email = "john@example.com"
```

如果您想查看还有哪些全局配置设置可用，可以使用以下命令:

```cs
git config --list
```

然后，您可以更改想要更改的设置。

# 去吧，林特克

如果您有一个当前没有使用 Git 版本控制的项目，您可以使用以下命令来初始化该项目:

```cs
git init
```

当您运行前面的命令时，您在机器中安装的 Git 程序在项目目录中创建一个`.git`目录，并开始跟踪该项目的源代码。在一个新项目中初始化 Git 后，所有文件都显示为“已修改”，您必须暂存这些文件以提交这些更改。

# Git 克隆

如果要使用远程服务器上的项目，必须克隆该项目。要克隆项目，您必须使用以下命令:

```cs
git clone [repo-url]
```

例如，如果要克隆角度项目，必须键入以下内容:

```cs
git clone https://github.com/angular/angular.git
```

当您将存储库克隆到您的本地环境时，`.git`文件夹被下载。这包括提交、分支、标记的历史，以及远程服务器中包含的所有其他信息。它基本上是远程服务器版本的副本。如果您提交对本地副本的更改，然后将其推送到远程存储库，则本地副本将与远程副本同步。

# Git 状态

工作时，您会想要检查当前代码的状态。这意味着找出哪些文件被修改，哪些文件被转移。您可以使用以下命令获取所有这些信息:

```cs
git status
```

我们来看一个例子。如果我们在我们的项目中添加一个名为`hello.txt`的新文件，由 Git 跟踪，并检查其状态，我们将看到如下内容:

![](assets/f99a31f5-fdff-4be7-98c6-d58b8ab02b59.png)

在这里，我们可以在`Untracked`文件下看到一个名为`hello.txt`的文件，这意味着这个文件还没有被 Git 跟踪。`git status`命令还会告诉您当前所在的分支。在这种情况下，我们处于`master`分支。

# 去把它给我

`git add`命令是将修改的文件/文件夹添加到 Git 跟踪系统的命令。这意味着文件和文件夹将被转移。该命令如下所示:

```cs
git add <file-name/folder-name>
```

让我们继续我们的例子，看看当我们在 Git 中添加`hello.txt`文件时会发生什么。为此，我们将执行以下命令:

```cs
git add hello.txt
```

输出如下:

![](assets/8032b4ee-0843-4aeb-b19b-a149a140fa86.png)

这里我们看到一个关于**换行** ( **LF** )和**回车** **、换行** ( **CR+LF** )的警告，是指某种格式。更换的原因是我们这里使用的是 Windows 操作系统，不过暂时不需要担心这个。这里的要点是文件已经被适当地转移了。现在，如果我们检查状态，我们将看到以下内容:

![](assets/1a59cee9-dde1-42e9-a8ce-930e2605be3f.png)

在这里，我们可以看到`hello.txt`文件被放置在`Changes to be committed`部分。这意味着文件已经被转移。

在实际的项目中，在暂存文件之前，您可能一次处理几个不同的文件。一个一个地添加文件，甚至用逗号分隔文件名都是非常乏味的。如果您想要暂存所有修改过的文件，可以使用以下命令将所有文件添加到暂存区域:

```cs
git add *
```

# 去吧，Committee

当您想要将代码提交到 Git 历史记录时，会使用`git commit`命令。这意味着获取代码库的快照，并将其存储在 g it 数据库中以供将来参考。要提交文件/文件夹，您必须使用以下命令:

```cs
git commit
```

如果您执行前面的代码，为 Git 设置的默认编辑器将打开，并要求您输入提交消息。还有一种更简单的方法。如果您想在提交时直接输入消息，可以运行以下命令:

```cs
git commit -m "your message"
```

现在让我们在 Git 存储库中提交我们的`hello.txt`文件。为此，我们将运行以下命令:

```cs
git commit -m "committing the hello.txt file with hello message" 
```

输出应该如下图所示:

![](assets/d6f675f4-c355-4775-9caf-5b231eb7ebee.png)

成功提交后，我们将看到线条`1 file changed, 1 insertion(+)`。如果您再次检查状态，您将看到没有要提交的内容，如下图所示:

![](assets/06f99414-18c3-4c4d-9563-e8e392f14451.png)

# Git 日志

要检查在存储库中进行了哪些提交，可以使用以下命令:

```cs
git log
```

输出如下所示:

![](assets/91189c17-7afe-4f05-8189-a4e5fc5facaa.png)

从日志中，我们可以看到到目前为止只有一次提交。我们可以看到提交的散列，它是单词`commit`旁边的数字。我们可以看到`commit`是由`Raihan Taher`在`master`分公司制造的。我们也可以在日志中看到`commit`的消息。这是一个非常有用的命令，可以检查已经提交的内容。

# Git remote

`git remote`命令用于查看您是否与远程存储库有任何连接。如果运行以下命令，它将显示远程存储库的名称。通常远程名称设置为`Origin`。您可以有多个远程存储库。让我们看一下命令:

```cs
git remote
```

如果我们执行这个命令，我们将看不到任何东西，因为还没有远程存储库，如下面的截图所示:

![](assets/af4087a5-badb-455e-9239-cc7b52d4179d.png)

让我们添加一个远程存储库。我们将使用 GitHub 作为我们的远程服务器。在 GitHub 中创建了一个存储库之后，我复制了那个存储库的 URL。我们将把它添加到我们的本地存储库中。为此，我们使用以下命令:

```cs
git remote add <remote-name> <repository-link-remote>
```

在我们的示例中，命令如下:

```cs
git remote add origin https://github.com/raihantaher/bookgitexample.git
```

在我们添加了我们的远程存储库之后，如果我们执行`git remote`，我们会看到`origin`被列为远程存储库，如下图截图所示:

![](assets/75dade12-09c0-4fab-9c49-18cc47759a1b.png)

如果您想查看关于远程存储库的更多细节，可以执行以下命令:

```cs
git remote -v
```

这将显示您添加的远程存储库的 URL，如下图所示:

![](assets/b198c049-5136-47e6-bb2c-2365a95d3337.png)

# Git 推送

当您想要将本地提交上传或推送到远程服务器时，可以使用以下命令:

```cs
git push <remote-repo-name> <local-branch-name>
```

以下是如何使用此命令的示例:

```cs
git push origin master
```

执行此命令后，如果推送成功，您将看到如下消息:

![](assets/ed93b671-65e1-4fe7-bc73-be880541f6d1.png)

# Git 拉取

当您想要从远程存储库中获取最新代码时，将使用`git pull`命令。由于 Git 是一个分布式版本控制系统，多人可以在一个项目上工作，所以有可能是其他人用最新的代码更新了远程服务器。要访问最新代码，请运行以下命令:

```cs
git pull <remote-repo-name> <local-branch-name>
```

下面是如何使用此代码的示例:

```cs
git pull origin master
```

如果我们运行这段代码，弹出的消息如下:

![](assets/e561a54b-2ebf-496b-a114-8ebf58e41f9f.png)

这意味着我们的本地存储库与远程存储库是同步的。如果远程存储库中有新的提交，则`git pull`命令会将这些更改拉至我们的本地存储库，并指示更改已经被拉。

# Git fetch

`git fetch`命令是一个非常类似于`git pull`的命令，但是，当您使用`git fetch`时，代码将从远程存储库提取到本地存储库，但不会与您的代码合并。检查完远程代码后，如果您想将其与本地代码合并，您必须显式运行一个`git merge`命令。执行此操作的命令如下:

```cs
git fetch <remote-repo>
```

如果运行前面的命令，远程存储库中的所有分支都将被更新。如果指定本地分支，将只更新该分支:

```cs
git fetch <remote-repo> <local-branch>
```

让我们在示例代码中尝试执行一个`git fetch`命令:

```cs
git fetch origin master
```

您将看到以下输出:

![](assets/032f5867-815b-48f5-be9d-d4d7a5048c59.png)

# Git 分支

分支通常被认为是 Git 最好的特性之一。分支使得 Git 不同于所有其他版本控制系统。它非常强大且易于使用。在我们了解不同的分支命令之前，让我简单解释一下 Git 是如何处理提交的，因为这将有助于您理解 Git 分支。在 Git 中，我们已经知道每个提交都有一个唯一的哈希，并且该哈希存储在 Git 数据库中。使用哈希，每次提交都会存储前一次提交的哈希，这就是所谓的提交父级。除此之外，还存储了另一个存储提交时暂存的文件的哈希，以及提交消息和关于提交者和作者的信息。对于存储库的第一次提交，父提交是空的。

下图显示了 Git 中的哈希示例:

![](assets/3dcb22af-ba87-4a31-a293-9ac6079c582c.png)

我们将提交中的所有信息称为快照。如果我们进行了三次提交，可以说我们依次拥有**快照 A** 、**快照 B** 和**快照 C** ，如下图所示:

![](assets/3df485a8-2ee2-4921-8b23-a4fde0b38713.png)

默认情况下，当您初始化本地 Git 存储库时，会创建一个名为`master`的分支。这是大多数开发人员视为 Git 树中主要分支的分支。这是可选的；您可以将任何分支机构视为您的主要分支机构或生产分支机构，因为所有分支机构都具有相同的能力和权力。如果从**快照 C** ( **提交 3** ，或简称为 **C3** 创建一个分支并命名为`feature`，一个分支将从 **C3** ( **提交 3** )开始，测试分支上的下一个提交将把 C3 视为父提交。

下图显示了分支:

![](assets/ce4743a5-97e8-4c76-aa3f-7a4ec0caaf3e.png)

**HEAD** 是指向活动提交或分支的指针。这是开发人员以及 Git 版本控制的一个指标。当您进行新的提交时，HEAD 会移动到最新的提交，因为这是将作为下一次提交的父级创建的快照。

# 创建分支

现在让我们看一下在 Git 中创建分支的命令。创建一个分支非常容易，因为它不会将整个代码库复制到一个新的地方，而只是与 Git 树保持一种关系。创建分支有几种方法，但最通用的方法如下:

```cs
git branch feature
```

命令行上应该如下所示:

![](assets/b2404d53-01bc-4c4d-9803-5381da16d2b9.png)

# 查看可用分支

要查看本地 Git 存储库中哪些分支可用，您可以编写以下命令:

```cs
git branch
```

执行上述代码后，您应该会看到以下输出:

![](assets/fcca175f-04b5-490c-b504-b81c3b9a8ecc.png)

我们可以看到，我们在本地存储库中有两个分支。一个是`master`分支，一个是`feature`分支。`* `字符表示头部指向的位置。

# 改变分支

在前面的例子中，我们看到，即使在创建了特征分支之后，HEAD 仍然指向主节点。切换到另一个分支的命令如下:

```cs
git checkout <branch-name>
```

在我们的例子中，如果我们想从`master`转移到`feature`分支，我们必须编写以下命令:

```cs
git checkout feature
```

输出如下:

![](assets/a5034adf-dd2e-4103-afde-9d72df501e53.png)

运行命令后，我们可以看到 Git 已经切换到`feature`分支。现在我们可以再次运行`git` `branch`命令来查看 HEAD 指向的位置，如下图所示:

![](assets/a7e605d1-aa7c-48ae-a8a9-4296f745c73f.png)

可能的情况是，当您创建一个分支时，您会希望立即处理该分支，因此有一个创建分支然后切换到它的快捷方式，如下面的代码所示:

```cs
git checkout -b newFeature
```

# 删除分支

要删除分支，您必须执行以下命令:

```cs
git branch -d feature
```

如果成功删除分支，您应该会看到类似于下面屏幕截图所示的消息:

![](assets/575435ef-b9ac-40f5-b244-bf367d2abe0c.png)

# Git 中的合并

要将一个分支与另一个分支合并，必须使用`merge`命令。请记住，您需要位于要合并代码的分支上，而不是要合并的分支或任何其他分支上。命令如下:

```cs
git merge newFeature
```

输出应如下所示:

![](assets/34f6e505-44e1-4d6d-b5f0-18bf24f25099.png)

# 摘要

在这一章中，我们了解了一个与 C#编程语言没有直接关系的概念，但它仍然是 C#开发人员的一个重要工具。微软最近购买了 GitHub，这是基于 Git 的最大的远程代码存储库网站，并将微软的大部分 IDEs/编辑器都集成到其中，包括最新的代码编辑器 Visual Code。这显示了 Git 对我们行业的重要性。我相信每个开发人员，无论是新的还是资深的，都应该对他们的代码使用版本控制。如果不使用 Git，可以使用市面上任何其他版本控制系统。然而，Git 是最好的，即使你没有在工作场所使用 Git，我也建议你在个人项目中使用它。Git 命令非常简单，所以您只需要用它练习几次，就可以完全理解它。

下一章有点不一样。我们将看看在工作面试中常见的一些问题。