# 前言

本书涵盖了现代基于云和分布式软件架构中最常见的设计模式和框架。它通过向您提供实际的现实场景，讨论何时以及如何使用每种模式。本书还介绍了 DevOps、微服务、Kubernetes、持续集成和云计算等技术和流程，以便您能够为客户开发和交付一流的软件解决方案。

本书将帮助您了解客户希望从您那里购买的产品。它将指导您交付和解决开发过程中可能遇到的最大问题。它还涵盖了在基于云的环境中管理应用程序时需要遵循的注意事项。您将了解不同的体系结构方法，如分层体系结构、面向服务的体系结构、微服务、单页应用程序和云体系结构，并了解如何将它们应用于特定的业务需求。

最后，您将使用 Azure 在远程环境或云上部署代码。本书中的所有概念都将借助于真实世界的实际用例进行解释，其中设计原则在创建安全和健壮的应用程序时起着重要作用。在本书的结尾，您将能够开发和交付满足最终客户业务需求的高度可扩展且安全的企业级应用程序。

值得一提的是，本书不仅将介绍软件架构师在开发 C#和.NET 核心解决方案时应遵循的最佳实践，还将讨论我们需要掌握的所有环境，以便根据最新趋势开发软件产品。

第二版在代码和解释方面得到了改进，并适应了 C#9 和.Net 5 提供的新机会。我们添加了去年出现的所有新框架和技术，如 gRPC 和 Blazor，并在专门的一章中更详细地描述了 Kubernetes。

# 这本书是给谁的

本书面向希望通过 C#提高 Azure 解决方案相关知识的任何软件架构师。它也适用于有志成为架构师或希望使用.NET 堆栈构建企业应用程序的工程师和高级开发人员。需要有 C#和.NET 的经验。

# 这本书涵盖的内容

*第一章**理解软件架构的重要性*，解释了软件架构的基础知识。本章将为您提供正确的心态来面对客户需求，然后选择正确的工具、模式和框架。

*第 2 章**非功能性需求*指导您进入应用程序开发的一个重要阶段，即收集并说明应用程序必须满足的所有约束和目标，如可伸缩性、可用性、弹性、性能、多线程、互操作性和安全性。

*第 3 章**使用 Azure DevOps*记录需求，描述了记录需求、bug 和其他应用程序信息的技术。虽然大多数概念都是通用的，但本章重点介绍 Azure DevOps 和 GitHub 的使用。

*第 4 章**决定了最佳的基于云的解决方案*，为您提供了云和 Microsoft Azure 上可用工具和资源的全面概述。在这里，您将学习如何搜索正确的工具和资源，以及如何配置它们以满足您的需求。

*第 5 章**将微服务体系结构应用于企业应用程序*，提供了微服务和 Docker 容器的广泛概述。在这里，您将了解基于微服务的体系结构如何利用云提供的所有机会，并了解如何使用微服务在云中实现灵活性、高吞吐量和可靠性。您将学习如何使用容器和 Docker 在您的体系结构中混合不同的技术，并使您的软件平台独立。

*第 6 章**Azure 服务结构*描述了 Azure 服务结构，它是 Microsoft 特定的微服务编排器。在这里，您将实现一个简单的基于微服务的应用程序。

*第 7 章**Azure Kubernetes 服务*描述了 Kubernetes 的 Azure 实现，这是微服务编排的事实标准。在这里，您将在 Kubernetes 上打包和部署微服务应用程序。

*第 8 章**与 C#-实体框架核心*中的数据交互，详细说明了您的应用程序如何借助**对象关系映射**（**ORMs**）尤其是实体框架核心 5.0 与各种存储引擎交互。

*第 9 章**如何选择云中的数据存储*，介绍了云中和 Microsoft Azure 中可用的主要存储引擎。在这里，您将学习如何选择最佳的存储引擎以实现所需的读/写并行性，以及如何配置它们。

*第 10 章**使用 Azure 函数*，描述了无服务器计算模型以及如何在 Azure 云中使用它。在这里，您将学习如何在需要运行某些计算时分配云资源，从而只支付实际计算时间。

*第 11 章*、*设计模式和.NET 5 实现*用.NET 5 实例描述了常见的软件模式。在这里，您将了解模式的重要性以及使用模式的最佳实践。

*第 12 章**了解软件解决方案*中的不同领域，描述了现代领域驱动设计软件生产方法，以及如何使用它来面对需要多个知识领域的复杂应用，以及如何使用它来利用基于云和微服务的架构。

*第 13 章**在 C#9*中实现代码可重用性，描述了在使用 C#9 的.NET 5 应用程序中最大化代码可重用性的模式和最佳实践。它还讨论了代码重构的重要性。

*第 14 章**应用以.NET 为核心的面向服务的体系结构*描述了面向服务的体系结构，它使您能够将应用程序的功能公开为 web 或专用网络上的端点，以便用户可以通过各种类型的客户端与之交互。在这里，您将学习如何使用 ASP.NET Core 和 gRPC 实现面向服务的体系结构端点，以及如何使用现有的 OpenAPI 包对它们进行自我记录。

*第 15 章**介绍了 ASP.NET 核心 MVC*，详细描述了 ASP.NET 核心框架。在这里，您将学习如何基于**模型视图控制器**（**MVC**模式）实现 web 应用程序，以及如何按照*第 12 章*中所述的领域驱动设计的规定组织它们，*理解软件解决方案*中的不同领域 .

*第 16 章**Blazor WebAssembly*描述了新的 Blazor 框架，该框架利用 WebAssembly 的强大功能在用户浏览器中运行.Net。在这里，您将学习如何在 C#中实现单页应用程序。

*第 17 章**编码 C#9 的最佳实践*描述了使用 C#9 开发.NET 5 应用程序时应遵循的最佳实践。

*第 18 章**使用单元测试用例和 TDD*测试您的代码，描述了如何测试您的应用程序。在这里，您将学习如何使用 xUnit 测试.NET 核心应用程序，并了解在测试驱动设计的帮助下如何轻松地开发和维护满足规范要求的代码。

*第 19 章**使用工具编写更好的代码*，描述评估软件质量的指标，以及如何借助 Visual Studio 中包含的所有工具来衡量这些指标。

*第 20 章**理解 DevOps 原则*描述了 DevOps 软件开发和维护方法的基础。在这里，您将学习如何组织应用程序的连续集成/连续交付周期。它还描述了如何自动化整个部署过程，从在源存储库中创建新版本到各种测试和批准步骤，再到在实际生产环境中最终部署应用程序。在这里，您将学习如何使用 Azure 管道和 GitHub 操作来自动化整个部署过程。

*第 21 章**应用 CI 场景的挑战*，用持续集成场景补充了 DevOps 的描述。

*第 22 章**功能测试自动化*专门用于自动功能测试，即自动验证整个应用程序版本是否符合约定的功能规范的测试。在这里，您将学习如何使用自动化工具模拟用户操作，以及如何将这些工具与 xUnit 结合使用来编写功能测试。

# 充分利用这本书

*   这本书涉及许多学科。将其理解为一个指南，您可能需要针对不同的情况多次重温。
*   不要忘记安装 Visual Studio Community 2019 或更高版本。
*   请确保您了解 C#NET 原则。

## 下载示例代码文件

该书的代码包托管在 GitHub 上的[https://github.com/PacktPublishing/Software-Architecture-with-C-9-and-.NET-5](https://github.com/PacktPublishing/Software-Architecture-with-C-9-and-.NET-5) 。我们在[上还提供了丰富的书籍和视频目录中的其他代码包 https://github.com/PacktPublishing/](https://github.com/PacktPublishing/) 。看看他们！

## 下载彩色图像

我们还提供了一个 PDF 文件，其中包含本书中使用的屏幕截图/图表的彩色图像。您可以在这里下载：[https://static.packt-cdn.com/downloads/9781800566040_ColorImages.pdf](https://static.packt-cdn.com/downloads/9781800566040_ColorImages.pdf) 。

## 使用的惯例

本书中使用了许多文本约定。

`CodeInText`：表示文本中的码字、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 句柄。例如“当您调用`sb.ToString()`以获得最终结果时，它们只在最终字符串中复制一次。”

代码块设置如下：

```
[Fact]
public void Test1()
{
    var myInstanceToTest = new ClassToTest();
    Assert.Equal(5, myInstanceToTest.MethodToTest(1));
} 
```

任何命令行输入或输出的编写方式如下：

```
kubectl create -f myClusterConfiguration.yaml 
```

**粗体**：表示一个新术语、一个重要单词或您在屏幕上看到的单词，例如在菜单或对话框中，也会出现在文本中，如下所示。例如：“在**解决方案资源管理器**中，您可以通过右键单击**发布……**选项。”

警告或重要提示如下所示。

提示和技巧如下所示。

# 联系

我们欢迎读者的反馈。

**一般反馈**：发送电子邮件`feedback@packtpub.com`，并在邮件主题中提及书名。如果您对本书的任何方面有疑问，请发送电子邮件至`questions@packtpub.com`。

**勘误表**：尽管我们已尽一切努力确保内容的准确性，但还是会出现错误。如果您在本书中发现错误，如果您能向我们报告，我们将不胜感激。请访问[http://www.packtpub.com/submit-errata](http://www.packtpub.com/submit-errata) ，选择您的书籍，点击勘误表提交表单链接，然后输入详细信息。

**盗版**：如果您在互联网上发现我们作品的任何形式的非法复制品，请您提供我们的位置地址或网站名称，我们将不胜感激。请通过`copyright@packtpub.com`与我们联系，并提供该材料的链接。

**如果您有兴趣成为一名作家**：如果您对某个主题有专业知识，并且您有兴趣撰写或贡献一本书，请访问[http://authors.packtpub.com](http://authors.packtpub.com) 。

## 评论

请留下评论。一旦你阅读并使用了这本书，为什么不在你购买它的网站上留下评论呢？然后，潜在读者可以看到并使用您的无偏见意见做出购买决定，我们 Packt 可以了解您对我们产品的看法，我们的作者可以看到您对他们书籍的反馈。非常感谢。

有关 Packt 的更多信息，请访问[packtpub.com](http://packtpub.com)。